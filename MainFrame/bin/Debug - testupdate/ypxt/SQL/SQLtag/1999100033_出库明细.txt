SELECT  Yp_out_detl.*,
A_employee_mi_2.name drawername, 
A_employee_mi_1.name keepername, 
Yp_dict.drugname, 
Yp_dict.drugname as dict_drugname,
Yp_dict.specification,
Yp_dict.pack_size,
Yp_unit.name,
Yp_dict.drug_id,
isnull(Yp_in_detl.manu_no,'') manu_no1,
isnull(Yp_in_detl.license_no,'') license_no1,
isnull(Yp_in_detl.supplyer,'') supplyer1,
Yp_dict.retprice old_retprice,
yp_dosage.name as dosage_name,                     
cj.manu_name as manufactory_name,
convert(float,0.0) as plan_amount,
space(20) as sort_no,
' ' as pcxz,
base.goods_where_code
FROM yp_out_detl Yp_out_detl 
inner join    yp_dict Yp_dict  on Yp_out_detl.charge_code = Yp_dict.charge_code and Yp_out_detl.serial = Yp_dict.serial  
left  join    a_employee_mi A_employee_mi_2   on Yp_out_detl.drawer = A_employee_mi_2.emp_sn   
left  join    a_employee_mi A_employee_mi_1   on Yp_out_detl.keeper = A_employee_mi_1.emp_sn
left  join    yp_unit Yp_unit  on Yp_dict.pack_unit = Yp_unit.code 
left  join    yp_in_detl Yp_in_detl  on Yp_out_detl.in_seri = Yp_in_detl.in_seri  and Yp_out_detl.in_date = Yp_in_detl.in_date
left join yp_dosage on (Yp_dict.dosage=yp_dosage.code)
left join yp_manufacture cj on Yp_out_detl.manufacture=cj.manu_code
left join yp_base base on Yp_out_detl.charge_code=base.charge_code and Yp_out_detl.serial=base.serial
         and Yp_out_detl.group_no_out=base.group_no
WHERE (Yp_out_detl.group_no_out = :group_no_out)
   AND  (Yp_out_detl.draw_no = :draw_no)
   AND  (Yp_out_detl.out_date = :out_date)
order by Yp_out_detl.out_seri, Yp_dict.drug_id, Yp_dict.dosage
