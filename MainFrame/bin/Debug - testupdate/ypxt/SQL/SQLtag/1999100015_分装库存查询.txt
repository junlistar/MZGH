select yp_base.charge_code,yp_base.serial,
       yp_dict.drug_id,yp_dict.drug_standard_id,
       yp_dict.drugname,yp_dict.dosage,
       yp_dict.concentration,yp_dict.weight,
       yp_dict.weight_unit,yp_dict.volum,yp_dict.vol_unit,
       yp_dict.mini_unit,yp_dict.pack_size,yp_dict.pack_unit,
       yp_dict.specification,yp_dict.fix_price,yp_dict.retprice,
       yp_dict.manufactory,yp_base.self_flag,
       yp_base.separate_flag,yp_base.suprice_flag,
       yp_base.drug_flag,yp_dict.py_code,yp_dict.d_code,
       yp_dict.infusion_flag,yp_dict.country_flag,yp_dict.divide_flag,
       yp_dict.deleted_flag,yp_dict.drug_kind,yp_dict.zy_bill_item,
       yp_dict.mz_bill_item,yp_dict.zy_charge_group,yp_dict.mz_charge_group,
       yp_dict.class_code,yp_dict.extend_code,yp_dict.supply_code,
       yp_dict.frequ_code,yp_dict.order_dosage,yp_dict.dosage_unit,
       yp_base.stock_amount,yp_base.group_no,
       yp_dict.audit_code,
       yp_unit.name chinaweight_unit,
       yp_unit1.name chinavol_unit,yp_unit2.name chinamini_unit,
       yp_unit3.name chinapack_unit,
       yp_dict.spe_comment,
       yp_dict.cooperate_flag,         
       yp_dict.mz_coop_group,
       yp_dict.zy_coop_group,
       case pack_size when 1 then '凑整量' else '分装量' end divide_text
from yp_base
inner join yp_dict  on  yp_base.charge_code=yp_dict.charge_code  and yp_base.serial=yp_dict.serial
left join  yp_unit   on yp_dict.weight_unit=yp_unit.code   
left join  yp_unit yp_unit1    on  yp_dict.vol_unit=yp_unit1.code
left join  yp_unit yp_unit2    on  yp_dict.mini_unit=yp_unit2.code
left join  yp_unit yp_unit3    on  yp_dict.pack_unit=yp_unit3.code
where yp_base.group_no=:group_no and isnull(yp_dict.deleted_flag,'0')='0'
and yp_base.charge_code=:charge_code
